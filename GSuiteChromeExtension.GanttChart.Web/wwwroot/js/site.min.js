"use strict";function onAuthApiLoad(){window.loginService.initClient(updateSigninStatus);authLoaded=!0;checkAvailable()}function onPickerApiLoad(){pickerLoaded=!0;checkAvailable()}function onGoogleApiLoaded(){gapi.load("client:auth2",onAuthApiLoad);gapi.load("picker",onPickerApiLoad)}function checkAvailable(){authLoaded&&pickerLoaded&&$("#btn-select-file").removeAttr("disabled")}function updateSigninStatus(n){n?checkDriveParams():loginService.signIn()}function checkDriveParams(){var t=getParameterByName("state"),n;t&&(n=JSON.parse(t),oauthToken=loginService.getAccessToken(),driveFileInfo&&(driveFileInfo={docs:[{}]}),oauthToken?(driveFileInfo.docs[0]={id:n.ids[0]},getUserSelectedFile()):loginService.signIn().then(function(){oauthToken=loginService.getAccessToken();driveFileInfo.docs[0]={id:n.ids[0]};getUserSelectedFile()}))}function getUserSelectedFile(){var n=driveFileInfo.docs[0],t="api/file/getFile?Token="+oauthToken+"&Id="+n.id,i=window.ViewerInstance.loadDocumentByUrl(t);Promise.resolve(i)}function getParameterByName(n){var r=window.location.href,i,t;return(n=n.replace(/[\[\]]/g,"\\$&"),i=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),t=i.exec(r),!t)?null:t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):""}function createPicker(){var r=$("[data-developer-key]").attr("data-developer-key"),n=$("[data-app-id]").attr("data-app-id"),t=(new google.picker.DocsView).setIncludeFolders(!1).setSelectFolderEnabled(!1).setQuery("*.swf"),i=(new google.picker.PickerBuilder).addView(t).enableFeature(google.picker.Feature.NAV_HIDDEN).setAppId(n).hideTitleBar().setOAuthToken(oauthToken).setCallback(pickerCallback).build();i.setVisible(!0)}function pickerCallback(n){n.action==="picked"&&n.docs&&n.docs.length&&(driveFileInfo=n,getUserSelectedFile())}function onSelectFileButtonClick(){oauthToken=loginService.getAccessToken();oauthToken?createPicker():loginService.signIn().then(function(){oauthToken=loginService.getAccessToken();createPicker()})}function enableEditAndDelete(){selectedTask&&($("#delete-task").removeAttr("disabled"),$("#edit-task").removeAttr("disabled"))}function disableEditAndDelete(){selectedTask||($("#delete-task").attr("disabled","disabled"),$("#edit-task").attr("disabled","disabled"))}function onRowClick(n){selectedTask=n;setSelectedTaskLabel(selectedTask.getName());enableEditAndDelete()}function onAddButtonClick(){$("#task-modal-action-btn").text("Add task");$("#task-modal-title").text("Add new task");isEditTask=!1;initSelect2()}function onEditButtonClick(){$("#task-modal-action-btn").text("Save changes");$("#task-modal-title").text("Edit task");isEditTask=!0;initSelect2();var n=$("#task-modal");n.find("input[name='task-name']").val(selectedTask.getName());n.find("select[name='task-type']").val(selectedTask.getGroup());n.find("input[name='task-start']").val(selectedTask.getStart().toISOString().substr(0,10));n.find("input[name='task-end']").val(selectedTask.getEnd().toISOString().substr(0,10));n.find("input[name='task-resource-name']").val(selectedTask.getResource());n.find("select[name='task-dependency']").val(selectedTask.getDepend());n.find("input[name='task-category']").val(selectedTask.getDataObject().category);n.find("input[name='task-note']").val(selectedTask.getNotes().textContent);n.find("input[name='task-cost']").val(selectedTask.getCost());n.find("input[name='task-completion']").val(selectedTask.getCompVal());n.find("input[name='task-milestone']")[0].checked=selectedTask.getMile()===1;n.find("select[name='task-parent']").val(selectedTask.getParent())}function onDeleteButtonClick(){Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(n){n.value&&(ganttChart.RemoveTaskItem(selectedTask.getID()),selectedTask=null,disableEditAndDelete(),setSelectedTaskLabel("none"),ganttChart.Draw(),Swal.fire("Deleted!","Your file has been deleted.","success"))})}function modalAction(n){var a;n.preventDefault();var t=$("#task-modal"),r=t.find("input[name='task-name']").val(),i=t.find("select[name='task-type']").val(),u=t.find("input[name='task-start']").val(),f=t.find("input[name='task-end']").val(),e=t.find("input[name='task-resource-name']").val(),o=t.find("select[name='task-dependency']").val(),s=t.find("input[name='task-category']").val(),h=t.find("input[name='task-note']").val(),c=t.find("input[name='task-cost']").val(),l=t.find("input[name='task-completion']").val(),v=t.find("input[name='task-milestone']")[0].checked,y=t.find("select[name='task-parent']").val()||0;isEditTask?(selectedTask.setName(r),selectedTask.setGroup(i),selectedTask.setStart(u),selectedTask.setEnd(f),selectedTask.setResource(e),selectedTask.setDepend(o),selectedTask.getDataObject().category=s,selectedTask.getNotes().textContent=h,selectedTask.setCost(c),selectedTask.setCompVal(l)):(a=i===1?"ggroupblack":"gtaskblue",ganttChart.AddTaskItemObject({pID:getNextId(),pName:r,pStart:u,pEnd:f,pClass:a,pMile:v?1:0,pRes:e,pComp:l,pGroup:i,pParent:y,pOpen:1,pDepend:o,pCaption:"",pCost:c,pNotes:h,category:s}));ganttChart.Draw();$("#task-modal").find("button[type='reset']").trigger("click")}function initSelect2(){var n=getSelect2TaskList();$("select[name='task-dependency']").select2({data:n,multiple:!0,width:"100%",containerCssClass:"form-control-border"});$("select[name='task-parent']").select2({data:n,multiple:!1,width:"100%",containerCssClass:"form-control-border"})}function setSelectedTaskLabel(n){$("#select-task-label").text(n)}function getTaskByName(n){var t=null;try{ganttChart.vTaskList.forEach(function(i){i.getName().toLowerCase()===n.toLowerCase()&&(t=i)})}catch(i){console.log(i)}return t}function getTaskByOriginalId(n){var t=null;try{ganttChart.vTaskList.forEach(function(i){i.getID()===n&&(t=i)})}catch(i){console.log(i)}return t}function getSelect2TaskList(){var n=[];return ganttChart.vTaskList.forEach(function(t){n.push({id:t.getID(),text:t.getName()})}),n}function getNextId(){var n=0;try{ganttChart.vTaskList.forEach(function(t){parseInt(t.getOriginalID())>n&&(n=parseInt(t.getOriginalID()))})}catch(t){console.log(t)}return n+1}var SCOPES="https://www.googleapis.com/auth/drive.file",CLIENT_ID=$("#loader").attr("data-client-id"),DISCOVERY_DOCS=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],authLoaded=!1,pickerLoaded=!1,ganttChart,selectedTask,isEditTask;window.loginService=new LoginService(CLIENT_ID,SCOPES,DISCOVERY_DOCS);window.driveService=new DriveService;$(document).ready(function(){var n=getParameterByName("state"),t;n&&(t=JSON.parse(n),onSelectFileButtonClick(function(n){n&&!n.error&&(oauthToken=n.access_token,driveFileInfo&&(driveFileInfo={docs:[{}]}),driveFileInfo.docs[0]={id:t.ids[0]},getUserSelectedFile())}))});$(function(){$("#btn-select-file").click(onSelectFileButtonClick)});$(document).ready(function(){ganttChart=new JSGantt.GanttChart(document.getElementById("GanttChartDIV"),"day");ganttChart.setOptions({vCaptionType:"Complete",vQuarterColWidth:36,vDateTaskDisplayFormat:"day dd month yyyy",vDayMajorDateDisplayFormat:"mon yyyy - Week ww",vWeekMinorDateDisplayFormat:"dd mon",vLang:"en",vShowTaskInfoLink:1,vShowEndWeekDate:0,vAdditionalHeaders:{category:{title:"Category"}},vUseSingleCell:1e4,vFormatArr:["Day","Week","Month","Quarter"],vEventClickRow:onRowClick});JSGantt.parseJSON(dataJsonUrl,ganttChart);ganttChart.AddTaskItemObject({pID:1,pName:"Define Chart API 2",pStart:"2017-02-25",pEnd:"2017-03-17",pPlanStart:"2017-04-01",pPlanEnd:"2017-04-15 12:00",pClass:"ggroupblack",pLink:"",pMile:0,pRes:"Brian",pComp:0,pGroup:1,pParent:0,pOpen:1,pDepend:"",pCaption:"",pCost:1e3,pNotes:"Some Notes text",category:"Example"});ganttChart.Draw();$("[data-dismiss=modal]").on("click",function(){var n=$(this),t=n[0].href||n.data("target")||n.parents(".modal")||[];$(t).find("input,textarea,select").val("").end().find("input[type=checkbox], input[type=radio]").prop("checked","").end()})});